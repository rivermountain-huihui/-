在Redis中，Master和Slave的同步机制

初次连接：全量复制

1.从节点连接主节点，发送PSYNC同步请求

2.主节点接收到同步请求后，开始执行BGSAVE命令，主进程会fork一个子进程用于执行BGSAVE记录这个记录点的数据，同时把开始复制后产生的数据改变记录到缓冲区，等子进程结束后，主节点的主进程把BGSAVE记录的数据发送给从节点

3.从节点接收数据，丢弃所有旧数据，并把新数据载入内存中

4.主服务发送完BGSAVE生成的数据后，开始把缓存区的内容也一并发送给从节点

主从复制已建立：部分复制

1.从节点发送同步请求，在同步请求中会加上自己的数据偏移量位置

2.主节点收到请求，检查数据偏移量后，把从这个偏移量之后的数据发送给从节点